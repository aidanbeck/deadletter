<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" type="text/css" href="desktop-div/structure.css">
        <link rel="stylesheet" type="text/css" href="aesthetics.css">
        <link rel="stylesheet" type="text/css" href="anchored.css">
        <link rel="stylesheet" type="text/css" href="ui.css">

    </head>
    <body>

        <div id="WORLD"></div>
        <div id="TRUCK">
            <div id="INVENTORY"></div>
        </div>
        <div id="HUD">
            <img id="GAUGE" src="images/ui/uiHud_fuelGauge.png">
            <img id="TIRE0" src="images/ui/uiHud_fullTire.png">
        </div>

        <script src="desktop-div/desktop-div.js"></script>
        <script src="interface.js"></script>
        
        
        <script>
            async function init() {
                // Load and instantiate the WebAssembly module
                const response = await fetch('latte.wasm');
                const buffer = await response.arrayBuffer();
                const module = await WebAssembly.instantiate(buffer);
            }
            init();

            desktopDiv.createDesktop (

                document.getElementById("WORLD"), // Element
                15*5,  //  Columns
                15,   //  Rows
                100/11,  //  Scale
                "vh" //  Measurement
            );

            scaleElement (

                document.getElementById("TRUCK"), // Element
                7,  //  Columns
                11,   //  Rows
                100/11,  //  Scale
                "vh" //  Measurement
            );

            desktopDiv.createDesktop (

                document.getElementById("INVENTORY"), // Element
                5,  //  Columns
                5,   //  Rows
                100/11,  //  Scale
                "vh" //  Measurement
            );

            scaleElement (

                document.getElementById("HUD"), // Element
                4,  //  Columns
                3,   //  Rows
                100/11,  //  Scale
                "vh" //  Measurement
            );

            scaleElement (

                document.getElementById("GAUGE"), // Element
                4,  //  Columns
                3,   //  Rows
                100/11,  //  Scale
                "vh" //  Measurement
            );

            scaleElement (

                document.getElementById("TIRE0"), // Element
                12/16,  //  Columns
                12/16,   //  Rows
                100/11,  //  Scale
                "vh" //  Measurement
            );




            desktopDiv.onClickFunction = function(icon) {

                const index = desktopDiv.getSlotIndex(icon.parentNode);

                _writeFromJS(index, SELECTEDTILE);

            };

            desktopDiv.onDropFunction = function(icon, draggedIcon) {

                const oldIndex = desktopDiv.getSlotIndex(draggedIcon.parentNode);
                const newIndex = desktopDiv.getSlotIndex(icon.parentNode);
                const tile = draggedIcon.tile;

                _writeFromJS(oldIndex, 0);
                _writeFromJS(newIndex, tile);
            }
          </script>
          <script async type="text/javascript" src="latte.js"></script>
    </body>
</html>